worker_processes auto;
events {
    worker_connections 1024;
    multi_accept on;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    # Logging
    access_log /dev/stdout;
    error_log /dev/stderr warn;

    # Gzip Compression
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript image/svg+xml;
    gzip_min_length 256;
    gzip_proxied any;
    gzip_vary on;

    # Open File Cache (increased inactivity time)
    open_file_cache max=2000 inactive=300s;
    open_file_cache_valid 600s;
    open_file_cache_min_uses 1;
    open_file_cache_errors on;

    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 65;
    types_hash_max_size 4096;

    # Server Block Configuration
    server {
        listen 80 default_server;
        listen [::]:80 default_server;

        server_name _;

        root /usr/share/nginx/html;
        index index.html;

        # SPA Routing Handling
        location / {
            try_files $uri $uri/ /index.html;
        }

        # Caching Static Files (increased caching duration)
        location ~* \.(?:css|js|jpg|jpeg|gif|png|svg|ico|woff|woff2|ttf|eot)$ {
            expires 1y;
            add_header Cache-Control "public, max-age=31536000, immutable";
            access_log off;
        }

        # Protect Hidden Files
        location ~ /\. {
            deny all;
        }

        # Security Headers
        add_header X-Content-Type-Options nosniff;
        add_header X-Frame-Options DENY;
        add_header X-XSS-Protection "1; mode=block";
    }
}
